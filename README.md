### 语料整理
将 https://github.com/NiuTrans/Classical-Modern 项目的语料整理为问答对的形式，用于训练
- **text_to_jsonl_converter.py**：
  - 按照总语料量的 30%，组织现代文-古文对，其余 70% 为古文-现代文对。</br>
**(使用以上语料训练后模型效果不佳，可能是prompt太长的原因，或者语料input、output太短导致学习有效性较差。)**

- **xiandai_ancient_to_jsonl_converter.py**：
  - 遍历指定目录及其子目录中的所有 'bitext.txt' 文件，提取其中的古文和现代文对应关系。
  - 将提取的文本对应关系组合成指定格式的 JSON 数据，并写入一个 JSONL 文件，同时确保每个 JSON 对象的总长度不超过 1024 个字符。</br>
**(使用尽可能长的文段生成训练语料。)**
  - 数据集可通过[REILX/Modern-Chinese-to-Classical-Chinese](https://huggingface.co/datasets/REILX/Modern-Chinese-to-Classical-Chinese)下载

### 模型训练
- 基础模型：[Qwen/Qwen2-7B-Instruct](https://huggingface.co/Qwen/Qwen2-7B-Instruct)
- 训练数据：[REILX/Modern-Chinese-to-Classical-Chinese](https://huggingface.co/datasets/REILX/Modern-Chinese-to-Classical-Chinese)
- 训练脚本：[hiyouga/LLaMA-Factory](https://github.com/hiyouga/LLaMA-Factory)
- 微调参数：
```bash
stage: sft
lora_rank: 32
lora_alpha: 64
finetuning_type: lora
lora_target: all
deepspeed: examples/deepspeed/ds_z3_config.json
learning_rate: 2.0e-5
num_train_epochs: 5.0
lr_scheduler_type: cosine
warmup_ratio: 0.05
```
- 训练时间：14小时46分

### Qwen2-7B-Instruct-Modern-to-Classical-Chinese 模型效果
![Qwen2-7B-Instruct-Modern-to-Classical-Chinese](./images/xiandaiwen-guwen-01.PNG)
```text
现代文：天地刚刚形成，混沌状态开始分离。阴阳力量交织，金木水火土五种元素相互生成。天道深奥难测，人间世事隐秘复杂。圣人观察这一切，理解了其中微妙的规律。然而，世人往往愚昧无知，不懂这些道理。因此，有修养的人注重自我完善，内心清澈。那些追逐利益、名声的小人，则迷失了自己的本质。真正的道理其实很简单，就是回归最原始的状态。要保持谦逊，如同山谷一样空旷，这样才能真正领悟到道。如果只坚持一种观点而忽视其他，最终只会导致偏颇。所以明智的人会审时度势，权衡各种利弊。顺应自然界的规律，不做违背自然的事情。只有这样，才能达到至善的境界，成就伟大的事业。

古文：天地之初，浑沌始开，阴阳交合，五行相生。天道玄远，人事幽微，圣人览观，得其机微；世之庸愚，不能明其理，故君子修己，心存澄澈，小人逐名利，失其本真。大道至简，复归于朴，谷虚如谷，方能悟道；执一弃万，终致偏颇，智者权衡，因时制宜，顺乎天，应乎物，方达至善，成大业。
```
![Qwen2-7B-Instruct-Modern-to-Classical-Chinese](./images/xiandaiwen-guwen-02.PNG)
```text
现代文：清晨，我踏上了泰山的石阶。晨雾缭绕，空气中弥漫着松柏的清香。随着海拔的上升，眼前的景色愈发壮阔。峰回路转间，忽见云海翻涌，如梦似幻。站在山顶，俯瞰大地，一种与天地融为一体的感觉油然而生。微风拂面，仿佛能听到大自然的呼吸。此刻，内心无比宁静，仿佛所有烦恼都已烟消云散，唯有对生命和自然的敬畏与感恩。

古文：晓日初上，步登泰岳之径，雾霭缭绕，松柏之气氤氲。渐行渐高，眼界愈宽，峰回路转，忽现云海翻腾，恍若仙境。临绝顶而眺，心旷神怡，天地之感油然而生。清风徐来，似闻自然之息，心灵宁静，烦恼尽消，唯余敬天畏生、感恩之情。
```
![Qwen2-7B-Instruct-Modern-to-Classical-Chinese](./images/xiandaiwen-guwen-03.PNG)
```text
现代文：夏日的午后，阳光透过树叶在地上投下斑驳的影子。我坐在公园的长椅上，看着来来往往的人群，思绪飘远。不远处，一对年轻的情侣正在草坪上野餐，他们的笑声轻快地飘荡在空气中。旁边的儿童游乐区里，孩子们欢快地奔跑、攀爬，充满了活力和童真。一位老爷爷正在给鸽子喂食，鸽群在他脚边盘旋，形成了一幅和谐的画面。微风拂过，带来一阵清凉，也带来了不知名花朵的香气。远处的湖面上，几只白鹭正悠闲地觅食，水面泛起微微的涟漪。天空中飘过几朵白云，懒洋洋地变换着形状。这样平凡而美好的一天，让人不禁感叹生活的美妙。虽然我们每个人都有自己的烦恼和压力，但在这样的时刻，一切似乎都变得不那么重要了。享受当下，感受生活中的每一个细节，或许这才是真正的幸福。我深吸一口气，闭上眼睛，让内心沉浸在这片刻的宁静中。当我再次睁开眼睛时，世界仿佛焕然一新，充满了希望和可能。

古文：夏之午，日光透叶，斑驳于地，吾坐于园之长凳，观人往来，思绪飘渺。遥闻不远之处，情侣二人，于草坪之上野餐，笑声轻扬，童稚游乐区，孩子们欢跑攀爬，生机盎然。老者喂鸽，鸽群盘旋足下，和谐相融。微风徐来，清凉带香，未知花之名，其香弥散。远处湖面，白鹭寻食，涟漪微动。天际白云，悠哉变换，不觉时光之流转，生活之美妙，尽在此刻。虽烦恼压力，亦暂忘却，享受此刻，感受生活之细微，此或为真幸福。深呼吸，闭眼静思，内心宁静，复睁眼，世界焕然一新，希望与可能，皆在其中。
```
### Qwen2-7B-Instruct 效果
![Qwen2-7B-Instruct](./images/qwen-01.PNG)
```text
现代文：天地刚刚形成，混沌状态开始分离。阴阳力量交织，金木水火土五种元素相互生成。天道深奥难测，人间世事隐秘复杂。圣人观察这一切，理解了其中微妙的规律。然而，世人往往愚昧无知，不懂这些道理。因此，有修养的人注重自我完善，内心清澈。那些追逐利益、名声的小人，则迷失了自己的本质。真正的道理其实很简单，就是回归最原始的状态。要保持谦逊，如同山谷一样空旷，这样才能真正领悟到道。如果只坚持一种观点而忽视其他，最终只会导致偏颇。所以明智的人会审时度势，权衡各种利弊。顺应自然界的规律，不做违背自然的事情。只有这样，才能达到至善的境界，成就伟大的事业。

古文：自开辟之初，天地混沌始分，阴与阳交合，金木水火土五行互生。天之道幽远难测，人间之事纷纭莫辨。圣人观此万化，洞悉其微，而世人多昧于斯理。故君子务自我修明，心澄如镜。小人逐财名之利，失其本真。大道至简，归于淳朴之态。须谦逊若谷，空怀无欲，方能得道真谛。偏执一端而蔽于众说，终致失衡。智者审乎时变，度诸利弊，顺乎自然之理，不违其道。唯此，乃臻至善之境，成就伟业。
```
![Qwen2-7B-Instruct](./images/qwen-02.PNG)
```text
现代文：清晨，我踏上了泰山的石阶。晨雾缭绕，空气中弥漫着松柏的清香。随着海拔的上升，眼前的景色愈发壮阔。峰回路转间，忽见云海翻涌，如梦似幻。站在山顶，俯瞰大地，一种与天地融为一体的感觉油然而生。微风拂面，仿佛能听到大自然的呼吸。此刻，内心无比宁静，仿佛所有烦恼都已烟消云散，唯有对生命和自然的敬畏与感恩。

古文：晨曦初露，余步入泰岳之石磴。薄霭缭绕，空氣中氤氲松柏之芳馥。步履渐高，所睹景象益发恢弘。山势蜿蜒，忽见云涛汹涌，恍若梦境幻境。立于峰颠，俯瞰大地，顿感与天壤合一之情愫油然而生。微风轻拂，犹闻自然之息。此时，心绪极静，世间诸般烦忧皆烟消云散，唯余对生命与自然之敬畏与感激之情。
```
![Qwen2-7B-Instruct](./images/qwen-03.PNG)
```text
现代文：夏日的午后，阳光透过树叶在地上投下斑驳的影子。我坐在公园的长椅上，看着来来往往的人群，思绪飘远。不远处，一对年轻的情侣正在草坪上野餐，他们的笑声轻快地飘荡在空气中。旁边的儿童游乐区里，孩子们欢快地奔跑、攀爬，充满了活力和童真。一位老爷爷正在给鸽子喂食，鸽群在他脚边盘旋，形成了一幅和谐的画面。微风拂过，带来一阵清凉，也带来了不知名花朵的香气。远处的湖面上，几只白鹭正悠闲地觅食，水面泛起微微的涟漪。天空中飘过几朵白云，懒洋洋地变换着形状。这样平凡而美好的一天，让人不禁感叹生活的美妙。虽然我们每个人都有自己的烦恼和压力，但在这样的时刻，一切似乎都变得不那么重要了。享受当下，感受生活中的每一个细节，或许这才是真正的幸福。我深吸一口气，闭上眼睛，让内心沉浸在这片刻的宁静中。当我再次睁开眼睛时，世界仿佛焕然一新，充满了希望和可能。

古文：夏之正午，日光穿叶，斑驳之影洒于地。余坐于园中长凳，观行人熙攘，神思恍惚。稍远处，少壮情侣于草坪设宴，笑声轻盈，萦绕空气。旁有戏耍孩童，欢腾跳跃，生机勃勃，稚气盎然。老翁于地撒食，群鸽旋绕其足，构成一幅和谐景致。微风徐来，携不知名花香，凉意袭人。湖面远处，白鹭数只悠游觅食，波纹轻漾。天际云朵飘过，慵懒变换姿容。此平凡且美好之日，令人心生感慨，生活之妙。虽人人皆有忧愁与压力，然在此刻，诸般似乎不复重要。享受此刻，品味生命点滴，或即为此等真乐。深呼吸一口，闭目凝神，心沉浸于这瞬息之静谧。复睁眼视之，世间仿佛新生，充满希望与可能。
```